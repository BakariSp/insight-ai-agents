# /update-docs — 项目文档自动更新

你是一个文档维护专家。你的任务是根据项目当前代码和 git 状态，更新 `docs/PROJECT.md` 全景文档，确保文档始终反映项目的真实现状。

## 执行步骤

### 1. 收集当前状态

执行以下操作收集项目信息:

- **Git 状态**: `git status`, `git log --oneline -20` 了解最近变更
- **Git Diff**: `git diff --stat` 了解未提交的改动
- **项目结构**: 扫描目录树，了解文件组织
- **依赖**: 读取 `requirements.txt` 了解技术栈变化
- **代码变更**: 读取所有有改动的文件，理解新增/修改的功能
- **测试**: 读取测试文件，了解测试覆盖情况
- **配置**: 读取 `.env.example` 和 `config.py`，了解配置变化

### 2. 分析变更影响

对比当前 `docs/PROJECT.md` 的内容和实际代码，识别:

- 路线图进度: 哪些 Phase/任务已完成、正在进行、新增
- 架构变化: 是否有新模块、新端点、新技能
- 技术栈变化: 依赖是否有增删
- API 变化: 端点是否有新增或修改
- 项目结构变化: 文件是否有增删重组

### 3. 更新文档

按以下规则更新 `docs/PROJECT.md`:

#### 更新规则

1. **最后更新日期**: 更新为今天
2. **当前阶段**: 根据路线图 checkbox 的完成度判断
3. **已实现列表 (§2.1)**: 新完成的功能打 ✅
4. **当前架构图 (§2.2)**: 如果架构有变化则更新
5. **待解决问题 (§2.4)**: 已解决的打 ✅，新发现的添加
6. **项目结构 (§5.1)**: 反映实际文件变化
7. **路线图 (§8)**:
   - 完成的任务: `- [ ]` → `- [x]`
   - 新增的任务: 添加到对应 Phase
   - 完成的 Phase: 标记 ✅
8. **变更日志 (§11)**: 在最前面添加本次更新的条目

#### 格式要求

- 保持中文为主的写作风格
- 保持现有的 markdown 结构和目录
- 代码块保持原格式
- 表格对齐
- 变更日志格式: `### YYYY-MM-DD — 简短标题`

### 4. 同步更新其他文档 (如需要)

如果变更涉及:
- API 契约变化 → 提醒是否需要更新 `docs/frontend-python-integration.md`
- 架构设计变化 → 提醒是否需要更新 `docs/python-service.md`

### 5. 输出摘要

更新完成后，输出:
```
📋 文档更新摘要
━━━━━━━━━━━━━━━
更新日期: YYYY-MM-DD
变更项数: N 处
主要变更:
  - ...
  - ...
路线图进度: Phase X — XX%
```

## 重要提示

- **只修改文档文件**，不要修改任何代码
- **基于事实**，只记录已经发生的变更，不要预测未来
- **保持简洁**，变更日志每条不超过一行
- 如果没有实质性变化，告知用户"文档已是最新，无需更新"
